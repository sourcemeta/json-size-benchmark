<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>{{ metadata.description }}</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  </head>
  <body>
    <h1>{{ metadata.description }}</h1>

    {{#each data}}
    <section>
      <h2>{{title}}</h2>
      <div>
        <canvas id="canvas-{{id}}"></canvas>
      </div>
    </section>
    {{/each}}

    <script id="data" type="application/json">{{{ JSONstringify data }}}</script>
    <script>
      const data = JSON.parse(document.getElementById('data').textContent);

      for (const entry of data) {
        const chart = new Chart(document.getElementById(`canvas-${entry.id}`), {
          type: 'bar',
          data: {
            labels: entry.labels,
            datasets: entry.datasets
          },
          options: {
            plugins: {
              title: {
                display: true,
                text: entry.title
              }
            },
            scales: {
              y: {
                beginAtZero: true
              }
            }
          }
        });
      }
    </script>
  </body>
</html>
